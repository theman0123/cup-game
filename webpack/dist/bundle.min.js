!function(e){function t(t){for(var i,o,r=t[0],c=t[1],h=t[2],l=0,u=[];l<r.length;l++)o=r[l],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&u.push(n[o][0]),n[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);for(p&&p(t);u.length;)u.shift()();return a.push.apply(a,h||[]),s()}function s(){for(var e,t=0;t<a.length;t++){for(var s=a[t],i=!0,r=1;r<s.length;r++){var c=s[r];0!==n[c]&&(i=!1)}i&&(a.splice(t--,1),e=o(o.s=s[0]))}return e}var i={},n={0:0},a=[];function o(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=i,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(s,i,function(t){return e[t]}.bind(null,i));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var r=window.webpackJsonp=window.webpackJsonp||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var h=0;h<r.length;h++)t(r[h]);var p=c;a.push([14,1]),s()}({14:function(e,t,s){"use strict";s.r(t);var i=s(2),n=s(9),a=s(0),o=function(){function e(e){this.keys=null,this.scene=e,this.enabled=!1}return e.prototype.set_input=function(e){this.keys=this.scene.input.keyboard.addKeys({up:"up",down:"down",left:"left",right:"right",space:"space"}),this.scene.input.keyboard.removeAllListeners("keydown"),this.scene.input.keyboard.removeAllListeners("keyup"),this.scene.input.keyboard.on("keydown",this.process_input,this),this.scene.input.keyboard.on("keyup",this.process_input,this),this.user_inputs=e,this.enabled=!0},e.prototype.getClassMethod=function(e,t,s){var i;return{classMethod:(i=this.scene[t][s])[e],classContext:i}},e.prototype.process_input=function(){if(this.enabled&&this.user_inputs)for(var e in this.keys){var t=this.keys[e];if("space"===e&&Phaser.Input.Keyboard.JustDown(t)){var s=this.user_inputs.keydown[e].method;return void this.scene.players[0][s]()}if(t.isDown){s=this.user_inputs.keydown[e].method;return void this.scene.players[0][s]()}this.scene.players[0].idle()}},e}(),r=function(e){function t(t){var s=e.call(this,{key:t})||this;return s.players=[],s.prefabs={},s.groups={},s}return Object(a.b)(t,e),t.prototype.init=function(e){this.level_data=e.level_data},t.prototype.create=function(){var e=this;if(this.level_data){if(this.level_data.groups.forEach((function(t){"players"!==t&&(e.groups[t]=e.add.group({defaultKey:t}))})),this.prefab_classes)for(var t in this.level_data.sprites){var s=this.level_data.sprites[t],i=this.cache.json.get("animations_"+s.asset_name);if("image"===s.type){var n=s.asset_name,r=s.group;this[r]||(this[r]={}),this[r][n]=this.add.image(0,0,n)}"tilemap"===s.type&&(this.MapClass=new this.prefab_classes[s.group](this,s)),"items"===s.type&&(this.items=new this.prefab_classes[s.group](this,s)),"spritesheet"===s.type&&("players"===s.group&&(this.players[0]=new this.prefab_classes[s.group](this,t,s.position,Object(a.a)(Object(a.a)({},s),i))),"items"===s.group&&(this.items=new this.prefab_classes[s.group](this,{name:t,maxQuantity:s.maxQuantity},Object(a.a)(Object(a.a)({},s),i))),"boss"===s.group&&(this.boss=new this.prefab_classes[s.group](this,t,s.position,Object(a.a)(Object(a.a)({},s),i))))}this.level_data.user_input&&(this.user_input_data=this.cache.json.get(this.level_data.user_input.key),this.user_input=new o(this),this.user_input&&this.user_input.set_input(this.user_input_data))}this.players.length&&(this.players[0].items=this.items,this.players[0].items.equipped=this.items)},t.prototype.update=function(e,t){this.user_input&&this.user_input.process_input()},t}(Phaser.Scene),c=function(e){function t(t,s,i,n){var a=e.call(this,t,i.x,i.y,n.texture,n.frame)||this;return a.scene=t,a.name=s,a.scene.add.existing(a),n.scale&&a.setScale(n.scale.x,n.scale.y),n.anchor&&a.setOrigin(n.anchor.x,n.anchor.y),a.scene.prefabs[s]=a,a}return Object(a.b)(t,e),t}(Phaser.GameObjects.Sprite),h=function(e){function t(t,s,i,n){var a=e.call(this,t,i.x,i.y,n.text,n.style)||this;return a.scene=t,a.name=s,a.scene.add.existing(a),a.scene.groups[n.group].add(a),n.scale&&a.setScale(n.scale.x,n.scale.y),n.anchor&&a.setOrigin(n.anchor.x,n.anchor.y),a.scene.prefabs[s]=a,a}return Object(a.b)(t,e),t}(Phaser.GameObjects.Text),p=function(e){function t(){var t=e.call(this,"TitleScene")||this;return t.prefab_classes={background:c.prototype.constructor,text:h.prototype.constructor},t}return Object(a.b)(t,e),t.prototype.start_game=function(){this.scene.start("BootScene",{scene:"east"})},t}(r),l=function(e){function t(t,s,i,n){var a=e.call(this,t,s,i,n)||this;return a.blockAnimation=!1,a.properties=n,a.scene=t,a.items=n.items,a.walking_speed=+n.walking_speed,a.body=new Phaser.Physics.Arcade.Body(t.physics.world,a),t.physics.world.enable(a),a.setScale(.5),a.scene.time.addEvent({delay:1e3,callback:function(){a.body.setSize(a.width,a.height,!0)},callbackScope:a,loop:!1}),a.body.setMaxSpeed(200),a.setPosition(100,100),n.animations.map(a.createAnimations,a),a.setPipeline("Light2D"),a.setDepth(1),a.body.setMass(.9),a}return Object(a.b)(t,e),t.prototype.create=function(){},t.prototype.createAnimations=function(e){var t=this.properties.animationProperties[e],s=t.frameRate,i=t.max,n=t.zero_pad,a=t.prefix,o=t.repeat,r=this.scene.anims.generateFrameNames(this.properties.asset_name,{end:i,zeroPad:n||2,prefix:a,suffix:".png"});this.scene.anims.create({key:e,frames:r,repeat:o,frameRate:s}),this.anims.play("idle")},t.prototype.update=function(){},t.prototype.idle=function(){this.blockAnimation||(this.body.setVelocityX(0),this.anims.play("idle"))},t.prototype.throw=function(){var e=this;this.anims.play("short-toss",!0),this.blockAnimation=!0,this.on("animationcomplete",(function(){e.blockAnimation&&(e.useItem(),e.blockAnimation=!1,e.anims.play("idle",!0))}))},t.prototype.jump=function(){this.body.blocked.down&&this.body.setVelocityY(-480)},t.prototype.left=function(){this.body.setVelocityX(-250),this.setFlipX(!0),this.playWalkAnim()},t.prototype.right=function(){this.body.setVelocityX(250),this.setFlipX(!1),this.playWalkAnim()},t.prototype.playWalkAnim=function(){var e=this.anims.currentAnim.key;"walk"!==e&&"short-toss"!==e&&this.anims.play("walk")},t.prototype.useItem=function(){var e;(null===(e=this.items)||void 0===e?void 0:e.equipped)&&this.items.equipped.use(this.body.x+this.width/2,this.body.y)},t}(c),u=function(e){function t(t,s,i,n){var a=e.call(this,t,s,i,n)||this;return a.previousX=a.x,a.previousY=a.y,a.scene=t,a}return Object(a.b)(t,e),t.prototype.use=function(e,t){this.enableBody(),this.body&&(this.body.reset(e,t),this.setActive(!0),this.setVisible(!0),this.setVelocityX(300),this.killTimer=this.scene.time.addEvent({delay:4e3,callback:this.markAsDead,callbackScope:this}))},t.prototype.markAsDead=function(){this.body&&this.killTimer&&(this.setActive(!1),this.setVisible(!1),this.disableBody(),this.killTimer.remove(!1))},t.prototype.preUpdate=function(t,s){e.prototype.preUpdate.call(this,t,s),this.body&&this.shouldDestroy()&&this.markAsDead()},t.prototype.shouldDestroy=function(){var e=+this.x.toFixed(2),t=+this.y.toFixed(2);return this.previousX===e&&this.previousY===t||(this.y>400||this.x>500||(this.previousX=e,this.previousY=t,!1))},t}(Phaser.Physics.Arcade.Sprite),d=function(e){function t(t,s,i){var n=e.call(this,t.physics.world,t)||this;n.createMultipleCallback=function(e){Phaser.Actions.Call(e,(function(e){var t=e.body,s=(e.height,e.width,t.halfWidth);e.setCircle(s),e.setBounce(.1),t.setMass(.6),t.setMaxVelocity(300)}),n)},n.scene=t,n.properties=i;var a=n.properties.animationProperties.plain,o=a.max,r=a.zero_pad,c=a.prefix,h=a.repeat,p=a.frameRate,l=n.scene.anims.generateFrameNames(n.properties.asset_name,{end:o,zeroPad:r||2,prefix:c,suffix:".png"});return n.scene.anims.create({key:"sphere-default",frames:l,repeat:h,frameRate:p}),n.createMultiple({frameQuantity:s.maxQuantity,key:s.name,active:!1,visible:!1,classType:u}),n.setDepth(1),n}return Object(a.b)(t,e),t.prototype.use=function(e,t){var s=this.getFirstDead();s&&s.use(e,t)},t}(Phaser.Physics.Arcade.Group),y=function(){function e(e,t){var s=this;this.scene=e,this.map=this.scene.make.tilemap({key:t.tiled_key}),this.tiles=this.map.addTilesetImage(t.tile_set_name,t.asset_name),this.scene.mapLayers={},this.map.layers.map((function(e){return s.handleLayers(e)})),this.scene.map=this.map}return e.prototype.handleLayers=function(e){var t,s=e.name;if("foreground"===s){(t=this.map.createDynamicLayer(s,this.tiles).setPipeline("Light2D")).setDepth(1),t.setCollisionByProperty({collision:!0}),i&&i.clear();var i=this.scene.add.graphics();t.renderDebug(i,{tileColor:null,collidingTileColor:new Phaser.Display.Color(243,134,48,200),faceColor:null}),i.depth=1}"background"===s&&(t=this.map.createStaticLayer(s,this.tiles)),"backdrop"===s&&(t=this.map.createStaticLayer(s,this.tiles)).setDepth(-1),this.scene.mapLayers[s]=t},e.prototype.handleObjectLayers=function(e){var t=e.objects.find((function(e){return"Start"===e.name})),s=e.objects.find((function(e){return"End"===e.name}));this.scene.sceneLights[e.name].setDepth(-1),this.scene.sceneLights[e.name].setPosition(t.x,t.y),this.scene.sunLight=this.scene.lights.addLight(600,0,1200).setIntensity(.2),this.scene.tween=this.scene.tweens.add({targets:[this.scene.sceneLights[e.name],this.scene.sunLight],x:s.x,y:s.y,ease:"Cubic",duration:5e3,repeat:-1,yoyo:!0}),this.scene.tweenLight=this.scene.tweens.add({targets:[this.scene.sunLight],intensity:1.5,ease:"Cubic",duration:5e3,repeat:-1,yoyo:!0})},e}(),f=function(e){function t(t,s,i,n){var a=e.call(this,t,s,i,n)||this;return a.blockAnimation=!1,a.properties=n,a.scene=t,a.items=n.items,a.body=new Phaser.Physics.Arcade.Body(t.physics.world,a),a.body.setAllowGravity(!1),t.physics.world.enable(a),a.setPipeline("Light2D"),a.setDepth(0),a.body.setMass(.9),a.body.setImmovable(),a}return Object(a.b)(t,e),t.prototype.create=function(){},t.prototype.createAnimations=function(e){var t=this.properties.animationProperties[e],s=t.frameRate,i=t.max,n=t.zero_pad,a=t.prefix,o=t.repeat,r=this.scene.anims.generateFrameNames(this.properties.asset_name,{end:i,zeroPad:n||2,prefix:a,suffix:".png"});this.scene.anims.create({key:e,frames:r,repeat:o,frameRate:s}),this.anims.play("idle")},t.prototype.update=function(){},t.prototype.idle=function(){},t.prototype.throw=function(){},t}(c),m=function(e){function t(){var t=e.call(this,"WorldScene")||this;return t.prefab_classes={players:l.prototype.constructor,map:y.prototype.constructor,items:d.prototype.constructor,boss:f.prototype.constructor},t}return Object(a.b)(t,e),t.prototype.create=function(){var t=this;e.prototype.create.call(this),this.lights.enable().setAmbientColor(15975008),this.lights.addLight(600,0,1200).setIntensity(1),this.map&&this.MapClass&&this.map.objects.map((function(e){return t.MapClass.handleObjectLayers(e)})),this.mainCamera=this.cameras.main,this.cameras.main.setBounds(0,0,this.sys.game.config.width,this.sys.game.config.height),this.cameras.main.fadeIn(1e3),this.cameras.main.startFollow(this.players[0]),this.mapLayers&&(this.physics.add.collider(this.players[0],this.mapLayers.foreground),this.physics.add.collider(this.mapLayers.foreground,this.items),this.physics.add.collider(this.items,this.items),this.physics.add.collider(this.items,this.boss)),this.game.scale.isFullscreen||this.fullScreenPrompt(),this.scene.launch("BootScene",{scene:"hud"})},t.prototype.update=function(){},t.prototype.create_object=function(e){var t={x:e.x+e.width/2,y:e.y+e.height/2};this.prefab_classes&&this.prefab_classes.hasOwnProperty(e.type)&&new this.prefab_classes[e.type](this,e.name,t,e.properties)},t.prototype.fullScreenPrompt=function(){var e=this,t=this.add.text(100,300,"FullScreen",{fill:"#fff"}).setDepth(2);t.setInteractive(),t.on("pointerover",(function(){console.log("pointerover")})),t.on("pointerdown",(function(){console.log("pointerdown"),e.game.scale.startFullscreen(),t.destroy()}))},t}(r),b=function(e){function t(){var t=e.call(this,{key:"BootScene"})||this;return t.sceneData={scene:""},t.levels={title:{key:"TitleScene",path:"assets/levels/title_screen.json"},hud:{key:"HUDScene",path:"assets/levels/hud.json"},east:{key:"WorldScene",path:"assets/levels/east.json"}},t}return Object(a.b)(t,e),t.prototype.init=function(e){this.sceneData=e},t.prototype.preload=function(){for(var e in this.levels){var t=this.levels[e];this.load.json(e,t.path)}},t.prototype.create=function(e){var t=this.cache.json.get(this.sceneData.scene);this.scene.start("LoadingScene",{level_data:t,scene:this.levels[this.sceneData.scene].key})},t}(Phaser.Scene),g=function(e){function t(){return e.call(this,{key:"LoadingScene"})||this}return Object(a.b)(t,e),t.prototype.init=function(e){this.level_data=e.level_data;this.add.text(320,240,"Loading",{font:"48px Kells",fill:"#ffffff"})},t.prototype.preload=function(){if(this.level_data){var e=this.level_data.sprites;for(var t in e){var s=e[t],i=s.asset_name;switch(s.type){case"image":this.load.image(i,s.source);break;case"items":case"spritesheet":this.load.multiatlas(s.asset_name,s.json,s.home),this.load.json("animations_"+s.asset_name,"/assets/animations/"+s.asset_name+".json");break;case"tilemap":this.load.multiatlas(s.asset_name,s.json,s.home),this.load.tilemapTiledJSON(s.tiled_key,s.tiled_source)}}this.level_data.user_input&&this.load.json(this.level_data.user_input.key,this.level_data.user_input.path)}},t.prototype.create=function(e){this.scene.launch(e.scene,{level_data:this.level_data}),this.scene.stop("LoadingScene")},t}(Phaser.Scene),v=function(e){function t(){var t=e.call(this,"HUDScene")||this;return t.interactive={"touch-icon":void 0},t.prefab_classes={},t}return Object(a.b)(t,e),t.prototype.create=function(){e.prototype.create.call(this),this.worldScene=this.scene.manager.getScene("WorldScene"),this.setupIcons(),this.setupTouchControls()},t.prototype.setupTouchControls=function(){var e=this;this.interactive["touch-icon"]&&(this.interactive["touch-icon"].setInteractive(),this.interactive["touch-icon"].on("pointermove",(function(t,s,i){t.isDown&&e.worldScene&&(t.prevPosition.x>t.x&&e.worldScene.players[0].left(),t.prevPosition.x<t.x&&e.worldScene.players[0].right())})),this.interactive["touch-icon"].on("pointerup",(function(t,s,i){e.worldScene&&e.worldScene.players[0].idle()})))},t.prototype.setupIcons=function(){var e=this.sys.game.canvas,t=e.width,s=e.height;this.grid=this.rexUI.add.gridSizer({width:t,height:50,column:5,row:1}).setOrigin(0),this.grid.setColumnProportion(0,.1),this.grid.setColumnProportion(1,.3),this.grid.setColumnProportion(2,.1),this.grid.setColumnProportion(3,.3),this.grid.setColumnProportion(4,.1),this.lowerGrid=this.rexUI.add.gridSizer({width:t,height:100,column:3,row:1,y:s-100}).setOrigin(0),this.lowerGrid.setColumnProportion(0,.3),this.lowerGrid.setColumnProportion(1,0),this.lowerGrid.setColumnProportion(2,.3),this.playerIcon&&this.grid.add(this.playerIcon["fox-icon"].setScale(.2),{column:0,row:0,padding:{top:10,left:10},expand:!1}),this.enemyIcon&&this.grid.add(this.enemyIcon["willow-icon"].setScale(.2),{column:4,row:0,padding:{top:10,right:10},expand:!1}),this.health&&(this.grid.add(this.health["health-icon"].setScale(.5),{column:1,row:0,padding:{top:10},expand:!1}),this.health["boss-health"]=this.add.image(0,0,"health-icon"),this.grid.add(this.health["boss-health"].setScale(.5),{column:3,row:0,padding:{top:10},expand:!1})),this.lowerGrid.add(this.interactive["touch-icon"].setScale(6,3).setAlpha(.4),{column:0,row:0,padding:{bottom:10,left:10},align:"left",expand:!1}),this.grid.layout(),this.lowerGrid.layout()},t.prototype.update=function(){},t}(r),_=new p,w=new m,k=new b,x=new g,S=new v,j={type:i.AUTO,parent:"cup-game",width:600,height:352,physics:{default:"arcade",arcade:{debug:!0,gravity:{y:300}}},fps:{},plugins:{scene:[{key:"rexUI",plugin:n.a,mapping:"rexUI"}]},scale:{mode:i.Scale.FIT,autoCenter:i.Scale.CENTER_BOTH}},P=new i.Game(j);P.scene.add("TitleScene",_),P.scene.add("WorldScene",w),P.scene.add("BootScene",k),P.scene.add("LoadingScene",x),P.scene.add("HUDSCene",S),P.scene.start("BootScene",{scene:"east"})}});